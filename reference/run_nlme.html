<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Run model in NONMEM — run_nlme • luna</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Run model in NONMEM — run_nlme"><meta name="description" content="Run the model directly using nmfe (not through pharmpy).
This is a more reliable way of running NONMEM, and it is now possible to
stream stdout and stderr to file or to console, which is useful for
inspection of intermediate model fit."><meta property="og:description" content="Run the model directly using nmfe (not through pharmpy).
This is a more reliable way of running NONMEM, and it is now possible to
stream stdout and stderr to file or to console, which is useful for
inspection of intermediate model fit."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">luna</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/InsightRX/uno/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Run model in NONMEM</h1>
      <small class="dont-index">Source: <a href="https://github.com/InsightRX/uno/blob/main/R/run_nlme.R" class="external-link"><code>R/run_nlme.R</code></a></small>
      <div class="d-none name"><code>run_nlme.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Run the model directly using nmfe (not through pharmpy).
This is a more reliable way of running NONMEM, and it is now possible to
stream stdout and stderr to file or to console, which is useful for
inspection of intermediate model fit.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">run_nlme</span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tables <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  full_tables <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">id</span>,</span>
<span>  path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nmfe"</span>, <span class="st">"pharmpy"</span>, <span class="st">"psn"</span><span class="op">)</span>,</span>
<span>  nmfe <span class="op">=</span> <span class="fu"><a href="get_nmfe_location_for_run.html">get_nmfe_location_for_run</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  force <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  console <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  save_fit <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  save_summary <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  auto_stack_encounters <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  clean <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  as_job <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  check_only <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>pharmpy model object or NONMEM model code (character) or path
to NONMEM model file.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>dataset (data.frame). Optional, can also be included in <code>model</code>
object (if specified as pharmpy model object).</p></dd>


<dt id="arg-tables">tables<a class="anchor" aria-label="anchor" href="#arg-tables"></a></dt>
<dd><p>acharacter vector of which default tables
to add, options are <code>fit</code> and <code>parameters</code>. Default is NULL,
i.e. don't add any new tables (but will keep existing).</p></dd>


<dt id="arg-full-tables">full_tables<a class="anchor" aria-label="anchor" href="#arg-full-tables"></a></dt>
<dd><p>For the default tables, should all input columns from be
included in the output tables? Default <code>FALSE</code>.</p></dd>


<dt id="arg-id">id<a class="anchor" aria-label="anchor" href="#arg-id"></a></dt>
<dd><p>run id, e.g. <code>run1</code>. This will be the folder in which the NONMEM
model is run. If no folder is specified, it will create a folder <code>run1</code> in
the current working directory, and will increment the run number for each
subsequent run.</p></dd>


<dt id="arg-path">path<a class="anchor" aria-label="anchor" href="#arg-path"></a></dt>
<dd><p>path to nonmem model. If not specified, will assume current
working directory.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>run method, either <code>pharmpy</code> dispatch, <code>nmfe</code> or <code>psn</code>
(psn::execute).</p></dd>


<dt id="arg-nmfe">nmfe<a class="anchor" aria-label="anchor" href="#arg-nmfe"></a></dt>
<dd><p>full path to nmfe file to run NONMEM with, if <code>method=="nmfe"</code>.</p></dd>


<dt id="arg-force">force<a class="anchor" aria-label="anchor" href="#arg-force"></a></dt>
<dd><p>if run folder (<code>id</code>) exists, should existing results be
removed before rerunning NONMEM? Default <code>FALSE</code>.</p></dd>


<dt id="arg-console">console<a class="anchor" aria-label="anchor" href="#arg-console"></a></dt>
<dd><p>show stderr and stdout in R console? If FALSE, will stream
to files <code>stdout</code> and <code>stderr</code> in fit folder.</p></dd>


<dt id="arg-save-fit">save_fit<a class="anchor" aria-label="anchor" href="#arg-save-fit"></a></dt>
<dd><p>save fit object. If <code>TRUE</code>, will save as &lt;run_id.rds&gt;. Can
also specify filename (rds) to save to.</p></dd>


<dt id="arg-save-summary">save_summary<a class="anchor" aria-label="anchor" href="#arg-save-summary"></a></dt>
<dd><p>save fit summary and parameter estimates to file?
Default is <code>TRUE</code>. Will use current folder, and save as
<code>fit_summary_&lt;id&gt;.txt</code> and <code>fit_parameters_&lt;id&gt;.csv</code>.</p></dd>


<dt id="arg-auto-stack-encounters">auto_stack_encounters<a class="anchor" aria-label="anchor" href="#arg-auto-stack-encounters"></a></dt>
<dd><p>only invoked if <code>data</code> argument supplied, not if
a pharmpy model object is supplied without <code>data</code>.
Detects if TIME within an individual is
decreasing from one record to another, which NONMEM cannot handle.
If this happens, it will add a reset event (EVID=3) at that time, and
increase the TIME for subsequent events so that NONMEM does not throw an
error. It will increase the time for the next encounter to the maximum
encounter length across all subjects in the dataset (rounded up to 100).
If no decreasing TIME is detected, nothing will be done (most common case).
This feature is useful e.g. for crossover trials when data on the same
individual ispresent but is included in the dataset as time-after-dose and
not actual time since first overall dose.</p></dd>


<dt id="arg-clean">clean<a class="anchor" aria-label="anchor" href="#arg-clean"></a></dt>
<dd><p>clean up run folder after NONMEM execution?</p></dd>


<dt id="arg-as-job">as_job<a class="anchor" aria-label="anchor" href="#arg-as-job"></a></dt>
<dd><p>run as RStudio job?</p></dd>


<dt id="arg-check-only">check_only<a class="anchor" aria-label="anchor" href="#arg-check-only"></a></dt>
<dd><p>if <code>TRUE</code>, will only check the model code (NM-TRAN in the case
of NONMEM), but not run the model. Will return <code>TRUE</code> if model syntax is
correct, and <code>FALSE</code> if not. Will also attach stdout as <code>message</code> attribute.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>verbose output?</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function does take a pharmpy model as input (optionally), and uses
pharmpy to read the results from the model fit, and returns a pharmpy
<code>modelfit</code> object.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ron Keizer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

